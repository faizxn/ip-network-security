

		#Juniper-MX-Firewall-CoPP#One#


set firewall family inet filter protect-router-control-plane term first-frag from first-fragment
set firewall family inet filter protect-router-control-plane term first-frag then count frag-discards
set firewall family inet filter protect-router-control-plane term first-frag then log
set firewall family inet filter protect-router-control-plane term first-frag then discard

set firewall family inet filter protect-router-control-plane term next-frag from is-fragment
set firewall family inet filter protect-router-control-plane term next-frag then count frag-discards
set firewall family inet filter protect-router-control-plane term next-frag then log
set firewall family inet filter protect-router-control-plane term next-frag then discard

set firewall family inet filter protect-router-control-plane term icmp-allow from source-address 10.160.0.0/24
set firewall family inet filter protect-router-control-plane term icmp-allow from source-address 10.160.1.0/24
set firewall family inet filter protect-router-control-plane term icmp-allow from source-address 43.224.111.0/24
set firewall family inet filter protect-router-control-plane term icmp-allow from source-address 103.43.148.0/24

set firewall family inet filter protect-router-control-plane term icmp-allow from source-prefix-list v6-prefix
set firewall family inet filter protect-router-control-plane term icmp-allow from protocol icmp
set firewall family inet filter protect-router-control-plane term icmp-allow then policer 50MB
set firewall family inet filter protect-router-control-plane term icmp-allow then accept

set firewall family inet filter protect-router-control-plane term ntp-allow from source-address 114.130.13.6/32
set firewall family inet filter protect-router-control-plane term ntp-allow from protocol udp
set firewall family inet filter protect-router-control-plane term ntp-allow from port ntp
set firewall family inet filter protect-router-control-plane term ntp-allow then accept

set firewall family inet filter protect-router-control-plane term ntp-other-discard from protocol udp
set firewall family inet filter protect-router-control-plane term ntp-other-discard from port ntp
set firewall family inet filter protect-router-control-plane term ntp-other-discard then discard

set firewall family inet filter protect-router-control-plane term snmp from source-address 103.43.148.149/32
set firewall family inet filter protect-router-control-plane term snmp from protocol udp
set firewall family inet filter protect-router-control-plane term snmp from destination-port snmp
set firewall family inet filter protect-router-control-plane term snmp then accept

set firewall family inet filter protect-router-control-plane term snmp-other from protocol udp
set firewall family inet filter protect-router-control-plane term snmp-other from destination-port snmp
set firewall family inet filter protect-router-control-plane term snmp-other then discard

set firewall family inet filter protect-router-control-plane term dns from source-address 103.43.148.148/32
set firewall family inet filter protect-router-control-plane term dns from source-address 8.8.8.8/32
set firewall family inet filter protect-router-control-plane term dns from protocol udp
set firewall family inet filter protect-router-control-plane term dns from destination-port domain
set firewall family inet filter protect-router-control-plane term dns then accept

set firewall family inet filter protect-router-control-plane term dns-other from protocol udp
set firewall family inet filter protect-router-control-plane term dns-other from port domain
set firewall family inet filter protect-router-control-plane term dns-other then discard

set firewall family inet filter protect-router-control-plane term syslog from source-address 103.244.184.37/32
set firewall family inet filter protect-router-control-plane term syslog from protocol udp
set firewall family inet filter protect-router-control-plane term syslog from port 514
set firewall family inet filter protect-router-control-plane term syslog then accept

set firewall family inet filter protect-router-control-plane term ospf from protocol ospf
set firewall family inet filter protect-router-control-plane term ospf then accept

set firewall family inet filter protect-router-control-plane term bgp from source-address 103.43.148.0/24

set firewall family inet filter protect-router-control-plane term bgp from protocol tcp
set firewall family inet filter protect-router-control-plane term bgp from port bgp
set firewall family inet filter protect-router-control-plane term bgp then accept

set firewall family inet filter protect-router-control-plane term bgp-deny from protocol tcp
set firewall family inet filter protect-router-control-plane term bgp-deny from port bgp
set firewall family inet filter protect-router-control-plane term bgp-deny then discard

set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS from source-prefix-list ROUTER-ACCESSLIST
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS from protocol tcp
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS from port telnet
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS then accept

set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-telnet-deny from protocol tcp
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-telnet-deny from port telnet
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-telnet-deny then discard

set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-ssh from source-prefix-list ROUTER-ACCESSLIST
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-ssh from protocol tcp
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-ssh from port ssh
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-ssh then accept

set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-ssh-deny from protocol tcp
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-ssh-deny from port ssh
set firewall family inet filter protect-router-control-plane term ROUTER-ACCESS-ssh-deny then discard

set firewall family inet filter protect-router-control-plane term v6-bgp from source-prefix-list v6-neighbor
set firewall family inet filter protect-router-control-plane term v6-bgp from protocol tcp
set firewall family inet filter protect-router-control-plane term v6-bgp from port bgp
set firewall family inet filter protect-router-control-plane term v6-bgp then accept

set firewall family inet filter protect-router-control-plane term v6-bgp-deny from protocol tcp
set firewall family inet filter protect-router-control-plane term v6-bgp-deny from port bgp
set firewall family inet filter protect-router-control-plane term v6-bgp-deny then discard

set firewall family inet filter protect-router-control-plane term icmp-reject from protocol icmp
set firewall family inet filter protect-router-control-plane term icmp-reject from icmp-type echo-request
set firewall family inet filter protect-router-control-plane term icmp-reject from icmp-type echo-reply
set firewall family inet filter protect-router-control-plane term icmp-reject from icmp-type time-exceeded
set firewall family inet filter protect-router-control-plane term icmp-reject from icmp-type unreachable
set firewall family inet filter protect-router-control-plane term icmp-reject then discard

set firewall family inet filter protect-router-control-plane term default-term then policer 10MB
set firewall family inet filter protect-router-control-plane term default-term then count copp-exceptions
set firewall family inet filter protect-router-control-plane term default-term then log
set firewall family inet filter protect-router-control-plane term default-term then accept


set firewall policer 50MB if-exceeding bandwidth-limit 50m
set firewall policer 50MB if-exceeding burst-size-limit 512k
set firewall policer 50MB then discard

set firewall policer 10MB if-exceeding bandwidth-limit 10m
set firewall policer 10MB if-exceeding burst-size-limit 512k
set firewall policer 10MB then discard

set policy-options prefix-list ROUTER-ACCESSLIST 27.54.150.0/24
set policy-options prefix-list ROUTER-ACCESSLIST 103.12.236.0/24
set policy-options prefix-list ROUTER-ACCESSLIST 103.43.148.0/24

set policy-options prefix-list v6-neighbor 2402:8640:1::2/128
set policy-options prefix-list v6-prefix 2407:0e80::/32

